{% extends '_head_foot.html' %}
{% load static %}
{% load i18n %}
{% block head_js %}
<script src="{% static 'accounts/js/account_list.js' %}"></script>
<script src="{% static 'accounts/js/set_current_date.js' %}"></script>
<link rel="stylesheet" href="https://cdn.staticfile.net/bootstrap-icons/1.11.3/font/bootstrap-icons.css">
<link rel="stylesheet" href="{% static 'bs_table/bootstrap-table.min.css' %}">
<script src="{% static 'bs_table/bootstrap-table.min.js' %}"></script>

<style>
.account-detail-card {
    border: 1px solid #e3e6f0;
    border-radius: 0.75rem;
    /* 取消外阴影效果 */
    /* box-shadow: 0 0.15rem 1.75rem 0 rgba(58, 59, 69, 0.15); */
    transition: all 0.3s ease;
}

.account-detail-card:hover {
    /* 取消hover时的外阴影和浮动效果 */
    /* box-shadow: 0 0.15rem 1.75rem 0 rgba(58, 59, 69, 0.25); */
    /* transform: translateY(-2px); */
}

.account-detail-table {
    margin-bottom: 0;
}

.account-detail-table .detail-label {
    font-weight: 600;
    color: #5a5c69;
    padding: 0.75rem 0.5rem;
    border-bottom: 1px solid #f8f9fc;
}

.account-detail-table .detail-value {
    font-weight: 500;
    color: #2e59d9;
    padding: 0.75rem 0.5rem;
    border-bottom: 1px solid #f8f9fc;
}

.status-tag-container {
    position: absolute;
    top: -10px;
    right: -10px;
    z-index: 10;
}

.status-badge {
    transform: rotate(15deg);
    font-size: 0.75rem;
    padding: 0.5rem 0.75rem;
    border-radius: 0.5rem;
    box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
    font-weight: 600;
    letter-spacing: 0.5px;
}

.status-badge.bg-success {
    background: linear-gradient(45deg, #1cc88a, #36e9ae) !important;
    border: 2px solid #fff;
}

.status-badge.bg-danger {
    background: linear-gradient(45deg, #e74a3b, #f56565) !important;
    border: 2px solid #fff;
}

.card-body {
    padding: 1.5rem;
    position: relative;
}

/* Responsive adjustments */
@media (max-width: 768px) {
    .status-tag-container {
        top: -5px;
        right: -5px;
    }
    
    .status-badge {
        font-size: 0.7rem;
        padding: 0.4rem 0.6rem;
    }
}
</style>
{% endblock %}

{% block main_page %}
<p id="account_id_p" style="display:none"></p>
<p id="account_name_p" style="display:none"></p>
<p id="detail_id_p" style="display:none"></p>
<div class="row">
  <div class="col-sm-3">
    <div>
      <div class="row">
        <div class="col-6 pt-2">
          <h4>{% trans "Accounts" %}</h4>
        </div>
        <div class="col-6">
          <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#new_account_modal">
            {% trans "New Account" %}
          </button>
        </div>
      </div>

    </div>
    <hr />
    <div id="accordion">
      {%for prop_list in type_prop%}
      <div class="card">
        <div class="card-header">
          <a class="btn" data-bs-toggle="collapse" href={{prop_list.href}}>{{prop_list.type_name}}</a>
        </div>
        <div id={{prop_list.id}} class="collapse show">
          <div class="card-body">
            <div class="list-group list-group-flush">
              {%for prop in prop_list.recs%}
              <li class="list-group-item list-group-item-action" id={{prop.id}}>{{prop.name}}</li>
              {%endfor%}
            </div>
          </div>
        </div>
      </div>
      {%endfor%}
    </div>
  </div>

  <div class="col-sm-9">
    <div class="row">
      <div class="col-4 pt-2">
        <h4>{% trans "Account Info" %}</h4>
      </div>
      <div class="container-fluid d-flex flex-row-reverse col-8">
      <div class="btn-group btn-group-sm" role="group" aria-label="Basic example">
        <button type="button" class="btn btn-primary btn-sm" id="prop_edit_btn" 
          data-bs-toggle="modal" data-bs-target="#prop_edit_modal" disabled><i class="bi bi-pencil-square"></i>{% trans "Edit" %}</button>
        <button type="button" class="btn btn-danger btn-sm" id="prop_del_btn" disabled><i class="bi bi-trash"></i>{% trans "Delete" %}</button>
        <button type="button" class="btn btn-warning btn-sm" id="prop_activate_btn" disabled><i class="bi bi-power"></i><span id="activate_text">{% trans "Deactivate" %}</span></button>
      </div>
      </div>
    </div>
    <hr />
    <div class="row">
      <div class="col-md-6">
        <div class="card account-detail-card">
          <div class="card-body position-relative">
            <!-- Status tag positioned at top-right corner -->
            <div class="status-tag-container">
              <span id="account_status_tag" class="badge bg-success status-badge">激活</span>
            </div>
            <table class="table table-borderless table-sm account-detail-table">
              <tbody>
                {%for show_rec in show_info%}
                {% if forloop.counter <= 4 %}
                <tr>
                  <td class="col-6 detail-label">{{show_rec.show}}</td>
                  <td id={{show_rec.id}} class="detail-value"></td>
                </tr>
                {% endif %}
                {%endfor%}
              </tbody>
            </table>
          </div>
        </div>
      </div>
      <div class="col-md-6">
        <div class="card account-detail-card">
          <div class="card-body">
            <table class="table table-borderless table-sm account-detail-table">
              <tbody>
                {%for show_rec in show_info%}
                {% if forloop.counter > 4 %}
                <tr>
                  <td class="col-6 detail-label">{{show_rec.show}}</td>
                  <td id={{show_rec.id}} class="detail-value"></td>
                </tr>
                {% endif %}
                {%endfor%}
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
    <hr />
    <div class="row">
      <div class="col-4 pt-2">
        <h4>{% trans "Trades" %}</h4>
      </div>
      <div class="container-fluid d-flex flex-row-reverse col-8">
        <div class="btn-group btn-group-sm" role="group" aria-label="Basic example">
          <button type="button" class="btn btn-primary btn-sm" id="detail_add_btn" 
          data-bs-toggle="modal" data-bs-target="#detail_new_modal" disabled><i class="bi bi-file-plus"></i>{% trans "Add Trades" %}</button>
          <button type="button" class="btn btn-primary btn-sm" id="detail_edit_btn" 
            data-bs-toggle="modal" data-bs-target="#detail_edit_modal" disabled><i class="bi bi-pencil-square"></i>{% trans "Edit Trades" %}</button>
          <button type="button" class="btn btn-danger btn-sm" id="detail_del_btn" disabled><i class="bi bi-trash"></i>{% trans "Delete Trades" %}</button>
        </div>
      </div>
    </div>
    <hr />
    <table 
      id="detail_table" data-pagination="true" 
      data-id-field="id"
      data-click-to-select="true"
      data-select-item-name="id"></table>
  </div>
</div>

<!-- new account Modal -->
<div class="modal fade" id="new_account_modal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel">{% trans "New Account" %}</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        {% load crispy_forms_tags %}
        {% crispy prop_new_form prop_new_form.helper %}
      </div>
    </div>
  </div>
</div>

<!-- 编辑对话框 -->
<div class="modal fade" id="prop_edit_modal" tabindex="-1" aria-labelledby="prop_edit_modal" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="prop_edit_modal">{% trans "Edit Account" %}</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        {% load crispy_forms_tags %}
        {% crispy prop_edit_form prop_edit_form.helper %}
      </div>
    </div>
  </div>
</div>

<!-- new detail Modal -->
<div class="modal fade" id="detail_new_modal" 
     tabindex="-1" aria-labelledby="exampleModalLabel" 
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel">{% trans "Add Trades" %}</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        {% load crispy_forms_tags %}
        {% crispy detail_new_form detail_new_form.helper %}
      </div>
    </div>
  </div>
</div>

<!-- edit detail Modal -->
<div class="modal fade" id="detail_edit_modal" 
     tabindex="-1" aria-labelledby="exampleModalLabel" 
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel">{% trans "Edit Trades" %}</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        {% load crispy_forms_tags %}
        {% crispy detail_edit_form detail_edit_form.helper %}
      </div>
    </div>
  </div>
</div>
{% endblock %}